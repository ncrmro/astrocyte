- name: Secure Remote Access
  apt: name={{item}} state=present
  with_items:
    - ufw
    - fail2ban

#- name: Setup ufw
#  ufw: state=enabled policy=deny
#
#- name: Allow ssh traffic
#  ufw: rule=allow port={{ ubuntu_common_ssh_port }} proto=tcp
#
##- name: Change ssh port
##  lineinfile: dest=/etc/ssh/sshd_config
##              regexp="^Port\s"
##              line="Port {{ ubuntu_common_ssh_port }}"
##              state=present
##  notify: Restart ssh
#
#- name: Disallow password authentication
#  lineinfile: dest=/etc/ssh/sshd_config
#              regexp="^PasswordAuthentication"
#              line="PasswordAuthentication no"
#              state=present
#  notify: Restart ssh
#
#- name: Disallow root SSH access
#  lineinfile: dest=/etc/ssh/sshd_config
#              regexp="^PermitRootLogin"
#              line="PermitRootLogin no"
#              state=present
#  notify: Restart ssh